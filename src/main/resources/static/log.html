<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8"/>
    <title>RFID 实时日志</title>
    <style>
        body{margin:0;background:#1e1e1e;color:#a9b7c6;font:14px/1.5 Consolas,monospace;}
        #log{padding:10px;white-space:pre-wrap;word-break:break-all;}
        .error{color:#f48771;}
    </style>
</head>
<body>
<div id="log">加载中……</div>

<script>
    (async () => {
        const logDiv = document.getElementById('log');
        try {
            const res = await fetch('/log/realtime?lines=300');
            if (!res.ok) throw new Error('请求失败 ' + res.status);

            const json = await res.json();
            if (!json.success || !Array.isArray(json.data)) {
                throw new Error('返回格式异常');
            }
            logDiv.textContent = json.data.join('\n');
        } catch (e) {
            logDiv.innerHTML = `<span class="error">读取日志失败：${e.message}</span>`;
        }
    })();
</script>
</body>
</html>